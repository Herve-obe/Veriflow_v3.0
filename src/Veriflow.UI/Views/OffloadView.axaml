<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Veriflow.UI.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1520" d:DesignHeight="820"
             x:Class="Veriflow.UI.Views.OffloadView"
             x:CompileBindings="False"
             x:DataType="vm:OffloadViewModel">
    
    <Design.DataContext>
        <vm:OffloadViewModel />
    </Design.DataContext>
    
    <!-- Professional Color Palette -->
    
    <!-- Professional Styles -->
    <UserControl.Styles>
        <!-- Drop Zone Card Style -->
        <Style Selector="Border.DropZone">
            <Setter Property="Background" Value="{StaticResource Brush.Surface.Card}" />
            <Setter Property="BorderBrush" Value="{StaticResource Brush.Border.Default}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="Padding" Value="20" />
        </Style>
        
        <!-- Professional Button Styles -->
        <Style Selector="Button.PrimaryAction">
            <Setter Property="Background" Value="{Binding $parent[Window].DataContext.ActivePageColor}" />
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Primary}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="14" />
        </Style>
        
        <Style Selector="Button.PrimaryAction:pointerover">
            <Setter Property="Background" Value="{StaticResource Brush.Accent.Video.HoverAlt}" />
        </Style>
        
        <Style Selector="Button.SecondaryAction">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Secondary}" />
            <Setter Property="BorderBrush" Value="{StaticResource Brush.Border.Default}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="FontSize" Value="13" />
        </Style>
        
        <Style Selector="Button.SecondaryAction:pointerover">
            <Setter Property="Background" Value="{StaticResource Brush.Surface.CardLight}" />
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Primary}" />
        </Style>
        
        <!-- TextBox Professional Style -->
        <Style Selector="TextBox.PathDisplay">
            <Setter Property="Background" Value="{StaticResource Brush.Surface.Input}" />
            <Setter Property="BorderBrush" Value="{StaticResource Brush.Border.Default}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Primary}" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Padding" Value="10,8" />
        </Style>
        
        <!-- DataGrid Professional Style -->
        <Style Selector="DataGrid">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="RowBackground" Value="Transparent" />
        </Style>
        
        <Style Selector="DataGridColumnHeader">
            <Setter Property="Background" Value="{StaticResource Brush.Surface.CardLight}" />
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Primary}" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Padding" Value="12,10" />
        </Style>
        
        <Style Selector="DataGridRow">
            <Setter Property="Foreground" Value="{StaticResource Brush.Text.Primary}" />
        </Style>
        
        <Style Selector="DataGridRow:pointerover /template/ Rectangle#BackgroundRectangle">
            <Setter Property="Fill" Value="{StaticResource Brush.Surface.CardLight}" />
        </Style>
    </UserControl.Styles>
    
    <Grid RowDefinitions="Auto,Auto,*,Auto" Background="{StaticResource Brush.Background.Primary}">
        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="4" Margin="20,20,20,24">
            <TextBlock Text="OFFLOAD - Secure Copy &amp; Verify" 
                      FontSize="24"
                      FontWeight="Bold"
                      Foreground="{StaticResource Brush.Text.Primary}" />
        </StackPanel>
        
        <!-- Mode Toggle + Actions -->
        <Grid Grid.Row="1" ColumnDefinitions="Auto,*,Auto,Auto" Margin="20,0,20,20">
            <!-- Offload/Verify Toggle -->
            <Border Grid.Column="0"
                   Background="{StaticResource Brush.Surface.Card}"
                   BorderBrush="{StaticResource Brush.Border.Default}"
                   BorderThickness="1"
                   CornerRadius="6"
                   Padding="10,8"
                   Height="40"
                   MinWidth="140">
                <Grid ColumnDefinitions="Auto,Auto" Width="100">
                    <TextBlock Grid.Column="0"
                              VerticalAlignment="Center"
                              Margin="4,0,8,0"
                              Width="50"
                              FontSize="14"
                              FontWeight="SemiBold"
                              Foreground="{StaticResource Brush.Text.Primary}"
                              Text="{Binding IsOffloadMode, Converter={StaticResource OffloadVerifyTextConverter}}" />
                    
                    <ToggleButton Grid.Column="1"
                                 IsChecked="{Binding IsOffloadMode, Mode=TwoWay}"
                                 Width="44"
                                 Height="22"
                                 Padding="0"
                                 CornerRadius="11"
                                 Background="{Binding $parent[Window].DataContext.ActivePageColor}"
                                 BorderThickness="0">
                        <ToggleButton.Styles>
                            <Style Selector="ToggleButton">
                                <Setter Property="Background" Value="{Binding $parent[Window].DataContext.ActivePageColor}" />
                                <Setter Property="Template">
                                    <ControlTemplate>
                                        <Border Background="{TemplateBinding Background}"
                                               CornerRadius="11"
                                               Padding="2">
                                            <Canvas Width="40" Height="18">
                                                <Ellipse Width="18" Height="18"
                                                        Fill="White"
                                                        Canvas.Left="22"
                                                        x:Name="PART_Thumb">
                                                    <Ellipse.Transitions>
                                                        <Transitions>
                                                            <DoubleTransition Property="Canvas.Left" Duration="0:0:0.2" />
                                                        </Transitions>
                                                    </Ellipse.Transitions>
                                                </Ellipse>
                                            </Canvas>
                                        </Border>
                                    </ControlTemplate>
                                </Setter>
                            </Style>
                            <Style Selector="ToggleButton:checked /template/ Ellipse#PART_Thumb">
                                <Setter Property="Canvas.Left" Value="0" />
                            </Style>
                            <Style Selector="ToggleButton:checked">
                                <Setter Property="Background" Value="{StaticResource Brush.Accent.Success}" />
                            </Style>
                        </ToggleButton.Styles>
                    </ToggleButton>
                </Grid>
            </Border>
            
            <!-- Reset All Button (Offload mode only) -->
            <Button Grid.Column="2"
                   Content="Reset All"
                   Command="{Binding ResetOffloadModeCommand}"
                   Classes="SecondaryAction"
                   Height="40"
                   Margin="12,0,0,0"
                   IsVisible="{Binding IsOffloadMode}"
                   VerticalContentAlignment="Center"
                   HorizontalContentAlignment="Center" />
            
            <!-- Reset All Button (Verify mode only) -->
            <Button Grid.Column="2"
                   Content="Reset All"
                   Command="{Binding ResetVerifyModeCommand}"
                   Classes="SecondaryAction"
                   Height="40"
                   Margin="12,0,0,0"
                   IsVisible="{Binding !IsOffloadMode}"
                   VerticalContentAlignment="Center"
                   HorizontalContentAlignment="Center" />
                   
            <!-- Start Button -->
            <Button Grid.Column="3"
                   Content="Start"
                   Classes="PrimaryAction"
                   Command="{Binding StartOffloadCommand}"
                   Click="StartButton_Click"
                   Width="150"
                   Height="40"
                   Margin="12,0,0,0"
                   VerticalContentAlignment="Center"
                   HorizontalContentAlignment="Center" />
        </Grid>
        
        <!-- Drop Zones -->
        <ScrollViewer Grid.Row="2" 
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="20,0">
                <!-- OFFLOAD MODE: Source + Destinations -->
                <Grid IsVisible="{Binding IsOffloadMode}" RowDefinitions="*,Auto,Auto">
                
                <!-- Cards Row -->
                <Grid Grid.Row="0" ColumnDefinitions="*,16,*,16,*">
                    <!-- Source Drop Zone (LEFT) -->
                    <Border Grid.Column="0"
                           Grid.Row="0"
                           Name="SourceDropZone"
                           DragDrop.AllowDrop="True"
                           Classes="DropZone" 
                           MinHeight="200">
                    <Grid RowDefinitions="Auto,*,Auto,Auto">
                        <TextBlock Grid.Row="0"
                                  Text="Source"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,16" />
                        
                        <StackPanel Grid.Row="1"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Spacing="16">
                            <!-- Upload Icon -->
                            <Path Width="72" Height="72"
                                 Fill="{StaticResource Brush.Text.Secondary}"
                                 Opacity="0.5"
                                 Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                                 Stretch="Uniform" />
                            
                            <TextBlock Text="DROP ZONE"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      HorizontalAlignment="Center" />
                            
                            <TextBlock Text="Drop files or folders here"
                                      FontSize="12"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      Opacity="0.7"
                                      HorizontalAlignment="Center" />
                        </StackPanel>
                        
                        <Grid Grid.Row="2" Margin="0,16,0,10">
                            <TextBox Classes="PathDisplay"
                                    Text="{Binding SourceFolder}"
                                    IsReadOnly="True"
                                    Watermark="No folder selected" />
                            <Button Content="✕"
                                   Command="{Binding ClearSourceCommand}"
                                   IsVisible="{Binding SourceFolder, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                   Background="Transparent"
                                   Foreground="{StaticResource Brush.Text.Secondary}"
                                   BorderThickness="0"
                                   FontSize="16"
                                   Width="30"
                                   Height="30"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Cursor="Hand" />
                        </Grid>
                        
                        <Button Grid.Row="3"
                               Content="Browse"
                               Command="{Binding SelectSourceFolderCommand}"
                               Classes="SecondaryAction"
                               HorizontalAlignment="Right" />
                    </Grid>
                </Border>
                    
                    <!-- Destination A -->
                    <Border Grid.Column="2"
                           Grid.Row="0"
                           Name="DestinationADropZone"
                           DragDrop.AllowDrop="True"
                           Classes="DropZone"
                           MinHeight="200">
                        <Grid RowDefinitions="Auto,*,Auto,Auto">
                            <TextBlock Grid.Row="0"
                                      Text="Destination 1"
                                      FontSize="14"
                                      FontWeight="Bold"
                                      Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                      Margin="0,0,0,16" />
                            
                            <StackPanel Grid.Row="1"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Spacing="16">
                                <!-- Upload Icon -->
                                <Path Width="72" Height="72"
                                     Fill="{StaticResource Brush.Text.Secondary}"
                                     Opacity="0.5"
                                     Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                                     Stretch="Uniform" />
                                
                                <TextBlock Text="DROP ZONE"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="{StaticResource Brush.Text.Secondary}"
                                          HorizontalAlignment="Center" />
                                
                                <TextBlock Text="Drop files or folders here"
                                          FontSize="12"
                                          Foreground="{StaticResource Brush.Text.Secondary}"
                                          Opacity="0.7"
                                          HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <Grid Grid.Row="2" Margin="0,16,0,10">
                                <TextBox Classes="PathDisplay"
                                        Text="{Binding DestinationA}"
                                        IsReadOnly="True"
                                        Watermark="No folder selected" />
                                <Button Content="✕"
                                       Command="{Binding ClearDestinationACommand}"
                                       IsVisible="{Binding DestinationA, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                       Background="Transparent"
                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                       BorderThickness="0"
                                       FontSize="16"
                                       Width="30"
                                       Height="30"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"
                                       Cursor="Hand" />
                            </Grid>
                            
                            <Button Grid.Row="3"
                                   Content="Browse"
                                   Command="{Binding SelectDestinationACommand}"
                                   Classes="SecondaryAction"
                                   HorizontalAlignment="Right" />
                        </Grid>
                    </Border>
                    
                    <!-- Destination B (Optional) -->
                    <Border Grid.Column="4"
                           Grid.Row="0"
                           Name="DestinationBDropZone"
                           DragDrop.AllowDrop="True"
                           Classes="DropZone"
                           MinHeight="200">
                        <Grid RowDefinitions="Auto,*,Auto,Auto">
                            <TextBlock Grid.Row="0"
                                      Text="Destination 2 (Optional)"
                                      FontSize="14"
                                      FontWeight="Bold"
                                      Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                      Margin="0,0,0,16" />
                            
                            <StackPanel Grid.Row="1"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Spacing="16">
                                <!-- Upload Icon -->
                                <Path Width="72" Height="72"
                                     Fill="{StaticResource Brush.Text.Secondary}"
                                     Opacity="0.5"
                                     Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                                     Stretch="Uniform" />
                                
                                <TextBlock Text="DROP ZONE"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="{StaticResource Brush.Text.Secondary}"
                                          HorizontalAlignment="Center" />
                                
                                <TextBlock Text="Drop files or folders here"
                                          FontSize="12"
                                          Foreground="{StaticResource Brush.Text.Secondary}"
                                          Opacity="0.7"
                                          HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <Grid Grid.Row="2" Margin="0,16,0,10">
                                <TextBox Classes="PathDisplay"
                                        Text="{Binding DestinationB}"
                                        IsReadOnly="True"
                                        Watermark="No folder selected" />
                                <Button Content="✕"
                                       Command="{Binding ClearDestinationBCommand}"
                                       IsVisible="{Binding DestinationB, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                       Background="Transparent"
                                       Foreground="{StaticResource Brush.Text.Secondary}"
                                       BorderThickness="0"
                                       FontSize="16"
                                       Width="30"
                                       Height="30"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"
                                       Cursor="Hand" />
                            </Grid>
                            
                            <Button Grid.Row="3"
                                   Content="Browse"
                                   Command="{Binding SelectDestinationBCommand}"
                                   Classes="SecondaryAction"
                                   HorizontalAlignment="Right" />
                        </Grid>
                    </Border>
                </Grid> <!-- End Cards Row -->
                
                <!-- File Progress Card (Empty for now) -->
                <Border Grid.Row="1" 
                       Margin="0,20,0,0"
                       Background="{StaticResource Brush.Surface.Card}"
                       BorderBrush="{StaticResource Brush.Border.Default}"
                       BorderThickness="1"
                       CornerRadius="6"
                       Padding="16"
                       Height="250">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Grid.Row="0"
                                  Text="File Progress"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,12" />
                        
                        <DataGrid Grid.Row="1"
                                 ItemsSource="{Binding OffloadFileProgress}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 GridLinesVisibility="None"
                                 HeadersVisibility="Column"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 CanUserReorderColumns="False"
                                 CanUserResizeColumns="True"
                                 CanUserSortColumns="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="File" 
                                                   Binding="{Binding FileName}"
                                                   Width="7*"
                                                   FontSize="12"
                                                   Foreground="{StaticResource Brush.Text.Primary}" />
                                <DataGridTextColumn Header="xxHash64" 
                                                   Binding="{Binding Hash}"
                                                   Width="1.8*"
                                                   FontSize="12"
                                                   FontFamily="JetBrains Mono"
                                                   Foreground="{StaticResource Brush.Text.Secondary}" />
                                <DataGridTemplateColumn Header="Status" Width="1.2*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Path Data="{Binding StatusIconData}"
                                                 Fill="{Binding StatusColor}"
                                                 Width="20"
                                                 Height="20"
                                                 Stretch="Uniform"
                                                 HorizontalAlignment="Center" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                            <DataGrid.Styles>
                                <Style Selector="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource Brush.Surface.Hover}" />
                                    <Setter Property="Foreground" Value="{StaticResource Brush.Text.Secondary}" />
                                    <Setter Property="FontSize" Value="12" />
                                    <Setter Property="FontWeight" Value="SemiBold" />
                                    <Setter Property="Padding" Value="12,8" />
                                    <Setter Property="BorderThickness" Value="0,0,0,1" />
                                    <Setter Property="BorderBrush" Value="{StaticResource Brush.Border.Default}" />
                                </Style>
                                <Style Selector="DataGridRow">
                                    <Setter Property="Height" Value="32" />
                                    <Setter Property="Background" Value="{StaticResource Brush.Background.Primary}" />
                                </Style>
                                <Style Selector="DataGridRow:nth-child(2n)">
                                    <Setter Property="Background" Value="{StaticResource Brush.Surface.Card}" />
                                </Style>
                                <Style Selector="DataGridCell">
                                    <Setter Property="Padding" Value="12,6" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </Style>
                            </DataGrid.Styles>
                        </DataGrid>
                    </Grid>
                </Border>
                
                <!-- Log Console Row -->
                <Border Grid.Row="2"
                       Margin="0,20,0,0"
                       Background="{StaticResource Brush.Surface.Card}"
                       BorderBrush="{StaticResource Brush.Border.Default}"
                       BorderThickness="1"
                       CornerRadius="6"
                       Padding="16"
                       MinHeight="150">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Grid.Row="0"
                                  Text="Log Console"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,12" />
                        
                        <ScrollViewer Grid.Row="1"
                                     VerticalScrollBarVisibility="Auto"
                                     HorizontalScrollBarVisibility="Auto"
                                     MaxHeight="150">
                            <TextBox Text="{Binding LogText}"
                                    IsReadOnly="True"
                                    Background="{StaticResource Brush.Surface.Input}"
                                    BorderThickness="0"
                                    FontFamily="Consolas"
                                    FontSize="12"
                                    Foreground="{StaticResource Brush.Text.Secondary}"
                                    TextWrapping="Wrap" />
                        </ScrollViewer>
                    </Grid>
                </Border>
                
            </Grid> <!-- End OFFLOAD MODE -->
            
            <!-- VERIFY MODE: Two Targets -->
            <Grid IsVisible="{Binding !IsOffloadMode}" RowDefinitions="*,Auto,Auto">
                
                <!-- Cards Row -->
                <Grid Grid.Row="0" ColumnDefinitions="*,24,*">
                    <!-- Verify Target #1 -->
                    <Border Name="VerifyTargetADropZone"
                           Grid.Column="0"
                           Grid.Row="0"
                           DragDrop.AllowDrop="True"
                           Classes="DropZone" 
                           MinHeight="200">
                    <Grid RowDefinitions="Auto,*,Auto,Auto">
                        <TextBlock Grid.Row="0"
                                  Text="Verify Target #1"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,16" />
                        
                        <StackPanel Grid.Row="1"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Spacing="16">
                            <Path Width="72" Height="72"
                                 Fill="{StaticResource Brush.Text.Secondary}"
                                 Opacity="0.5"
                                 Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                                 Stretch="Uniform" />
                            
                            <TextBlock Text="DROP ZONE"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      HorizontalAlignment="Center" />
                            
                            <TextBlock Text="Drop folder to verify here"
                                      FontSize="12"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      Opacity="0.7"
                                      HorizontalAlignment="Center" />
                        </StackPanel>
                        
                        <Grid Grid.Row="2" Margin="0,16,0,10">
                            <TextBox Classes="PathDisplay"
                                    Text="{Binding VerifyTargetA}"
                                    IsReadOnly="True"
                                    Watermark="No folder selected" />
                            <Button Content="✕"
                                   Command="{Binding ClearVerifyTargetACommand}"
                                   IsVisible="{Binding VerifyTargetA, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                   Background="Transparent"
                                   Foreground="{StaticResource Brush.Text.Secondary}"
                                   BorderThickness="0"
                                   FontSize="16"
                                   Width="30"
                                   Height="30"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Cursor="Hand" />
                        </Grid>
                        
                        <Button Grid.Row="3"
                               Content="Browse"
                               Command="{Binding SelectVerifyTargetACommand}"
                               Classes="SecondaryAction"
                               HorizontalAlignment="Right" />
                    </Grid>
                </Border>
                    
                    <!-- Verify Target #2 -->
                    <Border Name="VerifyTargetBDropZone"
                           Grid.Column="2"
                           Grid.Row="0"
                           DragDrop.AllowDrop="True"
                           Classes="DropZone" 
                           MinHeight="200">
                    <Grid RowDefinitions="Auto,*,Auto,Auto">
                        <TextBlock Grid.Row="0"
                                  Text="Verify Target #2 (Optional)"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,16" />
                        
                        <StackPanel Grid.Row="1"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Spacing="16">
                            <Path Width="72" Height="72"
                                 Fill="{StaticResource Brush.Text.Secondary}"
                                 Opacity="0.5"
                                 Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                                 Stretch="Uniform" />
                            
                            <TextBlock Text="DROP ZONE"
                                      FontSize="16"
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      HorizontalAlignment="Center" />
                            
                            <TextBlock Text="Drop folder to verify here"
                                      FontSize="12"
                                      Foreground="{StaticResource Brush.Text.Secondary}"
                                      Opacity="0.7"
                                      HorizontalAlignment="Center" />
                        </StackPanel>
                        
                        <Grid Grid.Row="2" Margin="0,16,0,10">
                            <TextBox Classes="PathDisplay"
                                    Text="{Binding VerifyTargetB}"
                                    IsReadOnly="True"
                                    Watermark="No folder selected" />
                            <Button Content="✕"
                                   Command="{Binding ClearVerifyTargetBCommand}"
                                   IsVisible="{Binding VerifyTargetB, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                                   Background="Transparent"
                                   Foreground="{StaticResource Brush.Text.Secondary}"
                                   BorderThickness="0"
                                   FontSize="16"
                                   Width="30"
                                   Height="30"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Cursor="Hand" />
                        </Grid>
                        
                        <Button Grid.Row="3"
                               Content="Browse"
                               Command="{Binding SelectVerifyTargetBCommand}"
                               Classes="SecondaryAction"
                               HorizontalAlignment="Right" />
                    </Grid>
                    </Border>
                </Grid> <!-- End Cards Row -->
                
                <!-- File Progress Card (Empty for now) -->
                <Border Grid.Row="1" 
                       Margin="0,20,0,0"
                       Background="{StaticResource Brush.Surface.Card}"
                       BorderBrush="{StaticResource Brush.Border.Default}"
                       BorderThickness="1"
                       CornerRadius="6"
                       Padding="16"
                       Height="250">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Grid.Row="0"
                                  Text="File Progress"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,12" />
                        
                        <DataGrid Grid.Row="1"
                                 ItemsSource="{Binding VerifyFileProgress}"
                                 AutoGenerateColumns="False"
                                 IsReadOnly="True"
                                 GridLinesVisibility="None"
                                 HeadersVisibility="Column"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 CanUserReorderColumns="False"
                                 CanUserResizeColumns="True"
                                 CanUserSortColumns="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="File" 
                                                   Binding="{Binding FileName}"
                                                   Width="7*"
                                                   FontSize="12"
                                                   Foreground="{StaticResource Brush.Text.Primary}" />
                                <DataGridTextColumn Header="xxHash64" 
                                                   Binding="{Binding Hash}"
                                                   Width="1.8*"
                                                   FontSize="12"
                                                   FontFamily="JetBrains Mono"
                                                   Foreground="{StaticResource Brush.Text.Secondary}" />
                                <DataGridTemplateColumn Header="Status" Width="1.2*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Path Data="{Binding StatusIconData}"
                                                 Fill="{Binding StatusColor}"
                                                 Width="20"
                                                 Height="20"
                                                 Stretch="Uniform"
                                                 HorizontalAlignment="Center" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                            <DataGrid.Styles>
                                <Style Selector="DataGridColumnHeader">
                                    <Setter Property="Background" Value="{StaticResource Brush.Surface.Hover}" />
                                    <Setter Property="Foreground" Value="{StaticResource Brush.Text.Secondary}" />
                                    <Setter Property="FontSize" Value="12" />
                                    <Setter Property="FontWeight" Value="SemiBold" />
                                    <Setter Property="Padding" Value="12,8" />
                                    <Setter Property="BorderThickness" Value="0,0,0,1" />
                                    <Setter Property="BorderBrush" Value="{StaticResource Brush.Border.Default}" />
                                </Style>
                                <Style Selector="DataGridRow">
                                    <Setter Property="Height" Value="32" />
                                    <Setter Property="Background" Value="{StaticResource Brush.Background.Primary}" />
                                </Style>
                                <Style Selector="DataGridRow:nth-child(2n)">
                                    <Setter Property="Background" Value="{StaticResource Brush.Surface.Card}" />
                                </Style>
                                <Style Selector="DataGridCell">
                                    <Setter Property="Padding" Value="12,6" />
                                    <Setter Property="BorderThickness" Value="0" />
                                </Style>
                            </DataGrid.Styles>
                        </DataGrid>
                    </Grid>
                </Border>
                
                <!-- Log Console Row -->
                <Border Grid.Row="2"
                       Margin="0,20,0,0"
                       Background="{StaticResource Brush.Surface.Card}"
                       BorderBrush="{StaticResource Brush.Border.Default}"
                       BorderThickness="1"
                       CornerRadius="6"
                       Padding="16"
                       MinHeight="150">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Grid.Row="0"
                                  Text="Log Console"
                                  FontSize="14"
                                  FontWeight="Bold"
                                  Foreground="{Binding $parent[Window].DataContext.ActivePageColor}"
                                  Margin="0,0,0,12" />
                        
                        <ScrollViewer Grid.Row="1"
                                     VerticalScrollBarVisibility="Auto"
                                     HorizontalScrollBarVisibility="Auto"
                                     MaxHeight="150">
                            <TextBox Text="{Binding LogText}"
                                    IsReadOnly="True"
                                    Background="{StaticResource Brush.Surface.Input}"
                                    BorderThickness="0"
                                    FontFamily="Consolas"
                                    FontSize="12"
                                    Foreground="{StaticResource Brush.Text.Secondary}"
                                    TextWrapping="Wrap" />
                        </ScrollViewer>
                    </Grid>
                </Border>
                
            </Grid> <!-- End VERIFY MODE -->
            
            </Grid> <!-- End Margin Grid -->
        </ScrollViewer>
    </Grid> <!-- End Main Grid -->
</UserControl>



